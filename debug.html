
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Weather Widget Debug</title>
  <style>
    :root { color-scheme: light dark; }
    body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; margin: 0; padding: 12px; }
    .container { border: 1px solid rgba(0,0,0,.1); border-radius: 16px; padding: 16px; background: rgba(255,255,255,0.05); box-shadow: 0 4px 12px rgba(0,0,0,0.05); }
    .btn { padding: 8px 14px; border-radius: 10px; border: 1px solid rgba(0,0,0,.15); background: #fff; color: #000; cursor: pointer; font-size: 14px; font-weight: 500; }
    .card { flex: 0 0 100px; padding: 12px; border: 1px solid rgba(0,0,0,.08); border-radius: 14px; text-align: center; background: rgba(255,255,255,0.3); transition: transform 0.2s; cursor: pointer; }
    .card.active { border-color: #ff922b; background: rgba(255,146,43,0.1); }
    .card:active { transform: scale(0.95); }
    /* The detail panel class that was missing in route.ts */
    .detail-panel { margin-top: 12px; padding: 14px; border-radius: 12px; background: rgba(0,0,0,0.04); font-size: 13px; line-height: 1.6; display: none; }
  </style>
</head>
<body>
  <div id="headline" style="font-size:20px; font-weight:700;">Debug View</div>
  <div class="container">
    <div id="panel"></div>
    <div id="detail" class="detail-panel"></div>
  </div>

  <script>
    // Copying the logic from route.ts (Step 294) to verify rendering
    function wmoToIcon(code) {
      if (code === null || code === undefined) return "â“";
      if (code === 0) return "â˜€ï¸";
      if (code === 1) return "ðŸŒ¤ï¸";
      if (code === 2) return "â›…";
      if (code === 3) return "â˜ï¸";
      if (code === 45 || code === 48) return "ðŸŒ«ï¸";
      if (code >= 51 && code <= 55) return "ðŸŒ¦ï¸";
      if (code >= 61 && code <= 65) return "â˜”";
      if (code >= 71 && code <= 75) return "â˜ƒï¸";
      if (code >= 80 && code <= 82) return "ðŸŒ§ï¸";
      if (code >= 95) return "â›ˆï¸";
      return "â˜ï¸";
    }

    const detail = document.getElementById("detail");
    const panel = document.getElementById("panel");

    const sampleDaily = {
      date: "2026-01-29",
      temp_max_c: 5.6,
      temp_min_c: -0.4,
      precip_prob_max_percent: 3,
      precip_sum_mm: 0,
      windspeed_max_kmh: 14,
      hourly: {
        time: ["2026-01-29T00:00", "2026-01-29T01:00", "2026-01-29T02:00", "2026-01-29T03:00", "2026-01-29T04:00"],
        weathercode: [0, 0, 0, 0, 0],
        temperature_2m: [0.8, 0.6, 0.4, 0.2, -0.1],
        precipitation_probability: [0, 0, 0, 0, 0]
      }
    };

    // Simulated render click logic from route.ts
    function showDetail(d) {
      const day = "æœ¨";
      detail.style.display = "block";
      detail.innerHTML = "";
      
      const header = document.createElement("div");
      header.style.cssText = "font-weight:700; margin-bottom:12px; font-size:14px; color: inherit;";
      header.textContent = d.date + ' (' + day + ') ã®è©³ç´°';
      detail.appendChild(header);

      const grid = document.createElement("div");
      grid.style.cssText = "display:grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 16px; font-size: 13px; opacity: 0.9;";
      
      const items = [
        { label: 'ðŸŒ¡ æ°—æ¸©', value: d.temp_min_c + 'ã€œ' + d.temp_max_c + 'â„ƒ' },
        { label: 'â˜” é™æ°´ç¢ºçŽ‡', value: d.precip_prob_max_percent + '%' },
        { label: 'ðŸ’§ é™æ°´é‡', value: (d.precip_sum_mm || 0) + 'mm' },
        { label: 'ðŸ’¨ æœ€å¤§é¢¨é€Ÿ', value: (d.windspeed_max_kmh || "-") + 'km/h' }
      ];

      items.forEach(item => {
        const div = document.createElement("div");
        div.textContent = item.label + ': ' + item.value;
        grid.appendChild(div);
      });
      detail.appendChild(grid);

      if (d.hourly && d.hourly.time) {
        const hTitle = document.createElement("div");
        hTitle.style.cssText = "font-size:12px; margin-bottom:12px; opacity:0.6; font-weight:600; border-top:1px solid rgba(128,128,128,0.2); padding-top:12px;";
        hTitle.textContent = "æ™‚é–“åˆ¥äºˆå ±";
        detail.appendChild(hTitle);

        const hContainer = document.createElement("div");
        hContainer.style.cssText = "display:flex; flex-direction:row; gap:10px; overflow-x:auto; padding:4px 0 16px 0; margin:0 -4px; -webkit-overflow-scrolling:touch; scroll-snap-type:x mandatory; white-space:nowrap;";
        
        d.hourly.time.forEach((t, i) => {
          const timeObj = new Date(t);
          const timeStr = String(timeObj.getHours()).padStart(2, '0') + ":00";
          const item = document.createElement("div");
          const isDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
          item.style.cssText = "flex: 0 0 75px; scroll-snap-align: start; text-align: center; padding: 12px 6px; border-radius: 14px; border: 1px solid rgba(128,128,128,0.2); background: " + (isDark ? 'rgba(255,255,255,0.08)' : '#ffffff') + "; box-shadow: 0 2px 6px rgba(0,0,0,0.05); display: inline-block; vertical-align: top;";
          
          const timeDiv = document.createElement("div");
          timeDiv.style.cssText = "opacity:0.6; margin-bottom:6px; font-size:11px; font-weight:600;";
          timeDiv.textContent = timeStr;
          
          const iconDiv = document.createElement("div");
          iconDiv.style.cssText = "font-size:24px; margin:8px 0;";
          iconDiv.textContent = wmoToIcon(d.hourly.weathercode[i]);
          
          const tempDiv = document.createElement("div");
          tempDiv.style.cssText = "font-weight:800; font-size:15px; margin-bottom:4px;";
          tempDiv.textContent = d.hourly.temperature_2m[i] + 'Â°';
          
          const probDiv = document.createElement("div");
          probDiv.style.cssText = "font-size:10px; font-weight:600; color: #1c7ed6;";
          probDiv.textContent = 'ðŸ’§ ' + d.hourly.precipitation_probability[i] + '%';
          
          item.appendChild(timeDiv);
          item.appendChild(iconDiv);
          item.appendChild(tempDiv);
          item.appendChild(probDiv);
          hContainer.appendChild(item);
        });
        detail.appendChild(hContainer);
      }
    }

    // Call it immediately for debug
    showDetail(sampleDaily);
  </script>
</body>
</html>
